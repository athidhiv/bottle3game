<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Multiplayer Bottle Arena</title>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
  <script src="/socket.io/socket.io.js"></script>

  <style>
    body {
      background: #111;
      color: white;
      font-family: Arial;
      text-align: center;
    }

    .panel {
      margin-top: 80px;
    }

    button, select, input {
      padding: 10px;
      margin: 6px;
      border-radius: 6px;
      border: none;
      font-size: 16px;
    }

    button {
      background: #3fa9f5;
      color: white;
      cursor: pointer;
    }

    input {
      width: 180px;
    }
  </style>
</head>

<body>
  <h2>Bottle Arena Multiplayer</h2>

  <div class="panel">
    <h3>Create Room</h3>

    <select id="createCapacity">
      <option value="3">3 Players</option>
      <option value="4">4 Players</option>
      <option value="5">5 Players</option>
    </select>

    <select id="createPrivate">
      <option value="false">Public</option>
      <option value="true">Private</option>
    </select>

    <br>
    <button onclick="createRoom()">Create Room</button>

    <p id="createdRoom"></p>
  </div>

  <hr style="width:40%; margin:40px auto;">

  <div class="panel">
    <h3>Join Game</h3>

    <select id="joinCapacity">
      <option value="3">3 Players</option>
      <option value="4">4 Players</option>
      <option value="5">5 Players</option>
    </select>

    <br><br>

    <input id="joinRoomName" placeholder="Room code (optional)">
    <br><br>

    <button onclick="joinGame()">Join Game</button>

    <p id="joinStatus"></p>
  </div>

  <script>
  const socket = io();

  function createRoom() {
    const numPlayers = parseInt(document.getElementById('createCapacity').value);
    const isPrivate = document.getElementById('createPrivate').value === "true";

    socket.emit('createRoom', { numPlayers, private: isPrivate });
  }

  socket.on('roomCreated', (roomName) => {
    document.getElementById('createdRoom').innerText = "Room created: " + roomName;

    const numPlayers = parseInt(document.getElementById('createCapacity').value);

    sessionStorage.setItem("roomName", roomName);
    sessionStorage.setItem("numPlayers", numPlayers);

    window.location.href = "/game.html";
  });

  function joinGame() {
    const numPlayers = parseInt(document.getElementById('joinCapacity').value);
    const roomName = document.getElementById('joinRoomName').value.trim();

    sessionStorage.setItem("roomName", roomName || "");
    sessionStorage.setItem("numPlayers", numPlayers);

    window.location.href = "/game.html";
  }

  socket.on('roomFull', () => {
    document.getElementById('joinStatus').innerText = "Room is full!";
  });

  socket.on('roomNotFound', () => {
    document.getElementById('joinStatus').innerText = "Room not found!";
  });
</script>

</body>
</html>
